/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "/";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./bin/start-webapp.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./app.js":
/*!****************!*\
  !*** ./app.js ***!
  \****************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var express_jwt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! express-jwt */ \"express-jwt\");\n/* harmony import */ var express_jwt__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(express_jwt__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var cookie_parser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! cookie-parser */ \"cookie-parser\");\n/* harmony import */ var cookie_parser__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(cookie_parser__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var express_form_data__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! express-form-data */ \"express-form-data\");\n/* harmony import */ var express_form_data__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(express_form_data__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! os */ \"os\");\n/* harmony import */ var os__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(os__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var morgan__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! morgan */ \"morgan\");\n/* harmony import */ var morgan__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(morgan__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var cors__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! cors */ \"cors\");\n/* harmony import */ var cors__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(cors__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var helmet__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! helmet */ \"helmet\");\n/* harmony import */ var helmet__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(helmet__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var ddos__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ddos */ \"ddos\");\n/* harmony import */ var ddos__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(ddos__WEBPACK_IMPORTED_MODULE_9__);\n/* harmony import */ var _routes_api__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./routes/api */ \"./routes/api.js\");\n/* harmony import */ var _routes_admin_api__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./routes/admin-api */ \"./routes/admin-api.js\");\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./core/config */ \"./core/config.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst app = express__WEBPACK_IMPORTED_MODULE_0___default()();\nconst cwd = process.cwd();\nconst ddos = new ddos__WEBPACK_IMPORTED_MODULE_9___default.a({\n  maxcount: process.env.DDOS_MAXCOUNT,\n  burst: process.env.DDOS_BURST,\n  limit: process.env.DDOS_LIMIT\n});\nconst options = {\n  uploadDir: os__WEBPACK_IMPORTED_MODULE_5___default.a.tmpdir(),\n  autoClean: true\n}; // view engine setup\n\napp.set(\"views\", path__WEBPACK_IMPORTED_MODULE_2___default.a.join(cwd, \"views\"));\napp.set(\"view engine\", \"pug\");\napp.use(morgan__WEBPACK_IMPORTED_MODULE_6___default()(\"dev\"));\napp.use(express__WEBPACK_IMPORTED_MODULE_0___default.a.json());\napp.use(express__WEBPACK_IMPORTED_MODULE_0___default.a.urlencoded({\n  extended: false\n}));\napp.use(cookie_parser__WEBPACK_IMPORTED_MODULE_3___default()());\n-app.use(express_form_data__WEBPACK_IMPORTED_MODULE_4___default.a.parse(options));\napp.use(express_form_data__WEBPACK_IMPORTED_MODULE_4___default.a.format());\napp.use(express_form_data__WEBPACK_IMPORTED_MODULE_4___default.a.stream());\napp.use(express_form_data__WEBPACK_IMPORTED_MODULE_4___default.a.union());\n true && app.use(cors__WEBPACK_IMPORTED_MODULE_7___default()());\napp.use(helmet__WEBPACK_IMPORTED_MODULE_8___default()()); // process.env.NODE_ENV === \"production\" && app.use(ddos.express);\n// app.use(\"/api/\", ddos.express);\n\napp.use(\"/admin/api\", express_jwt__WEBPACK_IMPORTED_MODULE_1___default()({\n  secret: _core_config__WEBPACK_IMPORTED_MODULE_12__[\"session\"].secretAdmin\n}).unless({\n  path: [/\\/admin\\/api\\/auth\\/*/]\n}));\napp.use(\"/api/posts/save\", express_jwt__WEBPACK_IMPORTED_MODULE_1___default()({\n  secret: _core_config__WEBPACK_IMPORTED_MODULE_12__[\"session\"].secret\n}));\napp.use(\"/admin/assets\", express__WEBPACK_IMPORTED_MODULE_0___default.a.static(path__WEBPACK_IMPORTED_MODULE_2___default.a.join(cwd, \"public\")));\napp.use(\"/assets\", express__WEBPACK_IMPORTED_MODULE_0___default.a.static(path__WEBPACK_IMPORTED_MODULE_2___default.a.join(cwd, \"public\")));\napp.use(\"/admin/api\", _routes_admin_api__WEBPACK_IMPORTED_MODULE_11__[\"default\"]);\napp.use(\"/api\", _routes_api__WEBPACK_IMPORTED_MODULE_10__[\"default\"]);\napp.use('/admin', express__WEBPACK_IMPORTED_MODULE_0___default.a.static(path__WEBPACK_IMPORTED_MODULE_2___default.a.join(cwd, 'admin-frontend')));\napp.get('/admin/*', function (req, res) {\n  res.sendFile(path__WEBPACK_IMPORTED_MODULE_2___default.a.join(cwd, 'admin-frontend/index.html'));\n});\napp.use(express__WEBPACK_IMPORTED_MODULE_0___default.a.static(path__WEBPACK_IMPORTED_MODULE_2___default.a.join(cwd, \"frontend\")));\napp.get(\"*\", (req, res) => {\n  res.sendFile(path__WEBPACK_IMPORTED_MODULE_2___default.a.join(cwd, \"frontend/index.html\"));\n}); // error handler\n\napp.use(function (err, req, res, next) {\n  // set locals, only providing error in development\n  res.locals.message = err.message;\n  res.locals.error = req.app.get(\"env\") === \"development\" ? err : {}; // render the error page\n\n  res.status(err.status || 500);\n  res.render(\"error\");\n});\n/* harmony default export */ __webpack_exports__[\"default\"] = (app);\n\n//# sourceURL=webpack:///./app.js?");

/***/ }),

/***/ "./bin/start-webapp.js":
/*!*****************************!*\
  !*** ./bin/start-webapp.js ***!
  \*****************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _app__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../app */ \"./app.js\");\n/* harmony import */ var debug__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! debug */ \"debug\");\n/* harmony import */ var debug__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(debug__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var http__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! http */ \"http\");\n/* harmony import */ var http__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(http__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var https__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! https */ \"https\");\n/* harmony import */ var https__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(https__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var cluster__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! cluster */ \"cluster\");\n/* harmony import */ var cluster__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(cluster__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../core/config */ \"./core/config.js\");\n\n\n\n\n\n\n\nlet debug;\nlet port;\nlet sslPort;\nlet httpServer;\nlet httpsServer;\n\nif (cluster__WEBPACK_IMPORTED_MODULE_4___default.a.isMaster) {\n  cluster__WEBPACK_IMPORTED_MODULE_4___default.a.fork();\n  cluster__WEBPACK_IMPORTED_MODULE_4___default.a.on(\"exit\", function (worker, code, signal) {\n    cluster__WEBPACK_IMPORTED_MODULE_4___default.a.fork();\n  });\n}\n\nif (cluster__WEBPACK_IMPORTED_MODULE_4___default.a.isWorker) {\n  debug = new debug__WEBPACK_IMPORTED_MODULE_1___default.a(\"express:server\");\n  port = normalizePort(_core_config__WEBPACK_IMPORTED_MODULE_6__[\"server\"].port);\n  sslPort = normalizePort(_core_config__WEBPACK_IMPORTED_MODULE_6__[\"server\"].sslPort);\n  _app__WEBPACK_IMPORTED_MODULE_0__[\"default\"].set(\"port\", port);\n  httpServer = http__WEBPACK_IMPORTED_MODULE_2___default.a.createServer(_app__WEBPACK_IMPORTED_MODULE_0__[\"default\"]);\n  httpServer.listen(port);\n  httpServer.on(\"error\", onError);\n  httpServer.on(\"listening\", onListening);\n  const credentials = {\n    key: fs__WEBPACK_IMPORTED_MODULE_5___default.a.readFileSync(_core_config__WEBPACK_IMPORTED_MODULE_6__[\"server\"].sslKey),\n    cert: fs__WEBPACK_IMPORTED_MODULE_5___default.a.readFileSync(_core_config__WEBPACK_IMPORTED_MODULE_6__[\"server\"].sslCert),\n    ca: [fs__WEBPACK_IMPORTED_MODULE_5___default.a.readFileSync(_core_config__WEBPACK_IMPORTED_MODULE_6__[\"server\"].sslCA)],\n    passphrase: \"abc123\"\n  };\n  httpsServer = https__WEBPACK_IMPORTED_MODULE_3___default.a.createServer(credentials, _app__WEBPACK_IMPORTED_MODULE_0__[\"default\"]);\n  httpsServer.listen(sslPort);\n  httpsServer.on(\"error\", onError);\n  httpsServer.on(\"listening\", onSslListening);\n}\n\nfunction normalizePort(val) {\n  const port = parseInt(val, 10);\n\n  if (isNaN(port)) {\n    // named pipe\n    return val;\n  }\n\n  if (port >= 0) {\n    // port number\n    return port;\n  }\n\n  return false;\n}\n\nfunction onError(error) {\n  if (error.syscall !== \"listen\") {\n    throw error;\n  }\n\n  const bind = typeof port === \"string\" ? \"Pipe \" + port : \"Port \" + port; // handle specific listen errors with friendly messages\n\n  switch (error.code) {\n    case \"EACCES\":\n      console.error(bind + \" requires elevated privileges\");\n      process.exit(1);\n      break;\n\n    case \"EADDRINUSE\":\n      console.error(bind + \" is already in use\");\n      process.exit(1);\n      break;\n\n    default:\n      throw error;\n  }\n}\n\nfunction onListening() {\n  const addr = httpServer.address();\n  const bind = typeof addr === \"string\" ? \"pipe \" + addr : \"port \" + addr.port;\n  debug(\"Listening on \" + bind);\n  console.log(\"Listening on \" + bind);\n}\n\nfunction onSslListening() {\n  const addr = httpsServer.address();\n  const bind = typeof addr === \"string\" ? \"pipe \" + addr : \"port \" + addr.port;\n  debug(\"Listening on \" + bind);\n  console.log(\"Listening on \" + bind);\n}\n\n//# sourceURL=webpack:///./bin/start-webapp.js?");

/***/ }),

/***/ "./core/config.js":
/*!************************!*\
  !*** ./core/config.js ***!
  \************************/
/*! exports provided: server, mysql, session, dbTblName, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"server\", function() { return server; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mysql\", function() { return mysql; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"session\", function() { return session; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"dbTblName\", function() { return dbTblName; });\n__webpack_require__(/*! dotenv */ \"dotenv\").config();\n\nconst server = {\n  isDev: false,\n  port: process.env.HTTP_PORT,\n  sslPort: process.env.HTTPS_PORT,\n  baseUrl: process.env.BASE_URL,\n  name: \"hrgulf.org\",\n  description: \"Portal in hrgulf.org\",\n  author: \"Zhenlong J.\",\n  secret: \"hrgulf@@\",\n  sslKey: \"./sslcert/server.key\",\n  sslCert: \"./sslcert/1e720c418ffe9875.crt\",\n  sslCA: \"./sslcert/gd_bundle-g2-g1.crt\",\n  environment: \"development\"\n};\nconst mysql = {\n  connectionLimit: 10,\n  host: process.env.MYSQL_HOST,\n  port: process.env.MYSQL_PORT,\n  user: process.env.MYSQL_USER,\n  password: process.env.MYSQL_PASSWORD,\n  database: process.env.MYSQL_DATABASE\n};\nconst session = {\n  name: \"knowledge.hrgulf.org\",\n  key: \"knowledge.hrgulf.org\",\n  secret: \"knowledge.hrgulf.org@@\",\n  secretAdmin: \"knowledge.hrgulf.org_admin@@\"\n};\nconst dbTblName = {\n  users: \"users\",\n  usersSigninHistory: \"users_signin_history\",\n  user_avatar: \"user_avatar\",\n  admins: \"admins\",\n  posts: \"posts\",\n  postTopics: \"post_topics\",\n  post2Topics: \"post2topics\",\n  comments: \"comments\",\n  comments_count: \"comments_count\",\n  news: \"news\",\n  video: \"video\",\n  questionnairePackages: \"questionnaire_packages\",\n  questionnaireQuestions: \"questionnaire_questions\",\n  questionnaireQuestionsCount: \"questionnaire_questions_count\",\n  questionnaireAnswers: \"questionnaire_answers\",\n  questionnaireResult: \"questionnaire_result\",\n  questionnaireResultCount: \"questionnaire_result_count\",\n  questionnaireAnsweredCount: \"questionnaire_answered_count\",\n  votePackages: \"vote_packages\",\n  voteQuestions: \"vote_questions\",\n  voteQuestionsCount: \"vote_questions_count\",\n  voteAnswers: \"vote_answers\",\n  voteResult: \"vote_result\",\n  voteResultCount: \"vote_result_count\",\n  contactUs: \"contact_us\",\n  eliteResourcesDb: \"portal3sections\",\n  consultants: \"director_board\"\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  server,\n  mysql,\n  session,\n  dbTblName\n});\n\n//# sourceURL=webpack:///./core/config.js?");

/***/ }),

/***/ "./core/consts.js":
/*!************************!*\
  !*** ./core/consts.js ***!
  \************************/
/*! exports provided: uploadPath, success, error, lang, defaultPageSize, defaultPageSize2, defaultLanguage, current, male, female, eliteResourcesUrl, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"uploadPath\", function() { return uploadPath; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"success\", function() { return success; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"error\", function() { return error; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"lang\", function() { return lang; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"defaultPageSize\", function() { return defaultPageSize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"defaultPageSize2\", function() { return defaultPageSize2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"defaultLanguage\", function() { return defaultLanguage; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"current\", function() { return current; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"male\", function() { return male; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"female\", function() { return female; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"eliteResourcesUrl\", function() { return eliteResourcesUrl; });\nconst uploadPath = {\n  posts: \"uploads/posts\",\n  news: \"uploads/news\",\n  avatars: \"uploads/avatars\"\n};\nconst success = \"success\";\nconst error = \"error\";\nconst lang = \"lang\";\nconst defaultPageSize = 10;\nconst defaultPageSize2 = 12;\nconst defaultLanguage = 'en';\nconst current = \"current\";\nconst male = \"M\";\nconst female = \"F\";\nconst eliteResourcesUrl = \"https://eliteresources.co\";\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  uploadPath,\n  success,\n  error,\n  lang,\n  defaultPageSize,\n  defaultPageSize2,\n  defaultLanguage,\n  current,\n  male,\n  female,\n  eliteResourcesUrl\n});\n\n//# sourceURL=webpack:///./core/consts.js?");

/***/ }),

/***/ "./core/db.js":
/*!********************!*\
  !*** ./core/db.js ***!
  \********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _dbConn__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dbConn */ \"./core/dbConn.js\");\n\nconst db = {};\n\ndb.query = (q, data) => {\n  return new Promise((resolve, reject) => {\n    _dbConn__WEBPACK_IMPORTED_MODULE_0__[\"default\"].query(q, data, (err, res) => {\n      err ? reject(err) : resolve(res);\n    });\n  });\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (db);\n\n//# sourceURL=webpack:///./core/db.js?");

/***/ }),

/***/ "./core/dbConn.js":
/*!************************!*\
  !*** ./core/dbConn.js ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var mysql2__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2 */ \"mysql2\");\n/* harmony import */ var mysql2__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./config */ \"./core/config.js\");\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (mysql2__WEBPACK_IMPORTED_MODULE_0___default.a.createPool(_config__WEBPACK_IMPORTED_MODULE_1__[\"default\"].mysql));\n\n//# sourceURL=webpack:///./core/dbConn.js?");

/***/ }),

/***/ "./core/i18n/ar.js":
/*!*************************!*\
  !*** ./core/i18n/ar.js ***!
  \*************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  success: \"success\",\n  error: \"danger\",\n  unknownServerError: \"خطأ غير معروف في الخادم\",\n  emailAlreadyRegistered: \"عنوان البريد الإلكترونى هذا مسجل بالفعل.\",\n  usernameAlreadyRegistered: \"وسجلت بالفعل اسم المستخدم هذا.\",\n  // successfullyRegistered: \"Successfully registered. Please activate your account by validation email.\",\n  successfullyRegistered: \"سجلت بنجاح. يرجى محاولة تسجيل الدخول.\",\n  emailIsIncorrect: \"البريد الالكتروني غير صحيح.\",\n  emailIsNotRegistered: \"البريد الإلكتروني غير مسجل\",\n  usernameIsIncorrect: \"اسم المستخدم غير صحيح\",\n  passwordIsIncorrect: \"كلمة المرور غير صحيحة\",\n  yourAccountIsNotAllowed: \"حسابك غير مسموح به. يرجى الاتصال بدعم العملاء.\",\n  yourAccountIsClosed: \"حسابك مغلق. يرجى الاتصال بدعم العملاء.\",\n  successfullySignedIn: \"تم تسجيل الدخول بنجاح\",\n  successfullySignedOut: \"تم تسجيل الخروج بنجاح\",\n  error404: \"لم يتم العثور على\",\n  error500: \"خطأ غير معروف في الخادم\",\n  successfullySaved: \"حفظ بنجاح\",\n  successfullyAdded: \"أضيف بنجاح\",\n  successfullyEdited: \"تم التعديل بنجاح\",\n  successfullyChanged: \"تغيرت بنجاح\",\n  successfullyDeleted: \"تم الحذف بنجاح\",\n  successfullyReset: \"إعادة تعيين بنجاح\",\n  currentPasswordIncorrect: \"كلمة المرور الحالية غير صحيحة.\",\n  failedDueToUnknownServerError: \"فشل بسبب خطأ غير معروف في الخادم\",\n  invalidParameters: \"معلمات غير صالحة\",\n  notUploaded: \"لم يتم الرفع\",\n  notFound: \"لم يتم العثور على\",\n  noData: \"ليس هنالك معلومات\",\n  successfullyUploaded: \"تم الرفع بنجاح\",\n  successfullyPosted: \"تم النشر بنجاح\",\n  successfullyJoined: \"تم التسجيل بنجاح\",\n  youHaveAlreadyJoined: \"لقد انضممت بالفعل\",\n  successfullySent: \"أرسلت بنجاح\",\n  invalidHash: \"توقيعك غير صالح.\",\n  invalidUser: \"معلوماتك غير صالحة.\",\n  notRegistered: \"انت لم تسجل.\",\n  male: \"الذكر\",\n  female: \"إناثا\"\n});\n\n//# sourceURL=webpack:///./core/i18n/ar.js?");

/***/ }),

/***/ "./core/i18n/en.js":
/*!*************************!*\
  !*** ./core/i18n/en.js ***!
  \*************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  success: \"success\",\n  error: \"danger\",\n  unknownServerError: \"Unknown server error\",\n  emailAlreadyRegistered: \"This email is already registered.\",\n  usernameAlreadyRegistered: \"This username is already registered.\",\n  // successfullyRegistered: \"Successfully registered. Please activate your account by validation email.\",\n  successfullyRegistered: \"Successfully registered. Please try to sign in.\",\n  emailIsIncorrect: \"Email is incorrect.\",\n  emailIsNotRegistered: \"Email is not registered.\",\n  usernameIsIncorrect: \"Username is incorrect\",\n  passwordIsIncorrect: \"Password is incorrect\",\n  yourAccountIsNotAllowed: \"Your account is not allowed. Please contact Customer Support.\",\n  yourAccountIsClosed: \"Your account is closed. Please contact Customer Support.\",\n  successfullySignedIn: \"Successfully signed in\",\n  successfullySignedOut: \"Successfully signed out\",\n  error404: \"Not Fount\",\n  error500: \"Unknown server error\",\n  successfullySaved: \"Successfully saved\",\n  successfullyAdded: \"Successfully added\",\n  successfullyEdited: \"Successfully edited\",\n  successfullyChanged: \"Successfully changed\",\n  successfullyDeleted: \"Successfully Deleted\",\n  successfullyReset: \"Successfully Reset\",\n  currentPasswordIncorrect: \"Current password is incorrect.\",\n  failedDueToUnknownServerError: \"Failed due to unknown server error\",\n  invalidParameters: \"Invalid Parameters\",\n  notUploaded: \"Not uploaded\",\n  notFound: \"Not Found\",\n  noData: \"There is no data\",\n  successfullyUploaded: \"Successfully uploaded\",\n  successfullyPosted: \"Successfully posted\",\n  successfullyJoined: \"Successfully joined\",\n  youHaveAlreadyJoined: \"You have already joined.\",\n  successfullySent: \"Successfully sent\",\n  invalidHash: \"Your signature is invalid.\",\n  invalidUser: \"Your information is invalid.\",\n  notRegistered: \"You are not registered.\",\n  male: \"Male\",\n  female: \"Female\"\n});\n\n//# sourceURL=webpack:///./core/i18n/en.js?");

/***/ }),

/***/ "./core/myCrypto.js":
/*!**************************!*\
  !*** ./core/myCrypto.js ***!
  \**************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./config */ \"./core/config.js\");\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  hmacHex: plain => {\n    const cipher = crypto__WEBPACK_IMPORTED_MODULE_0___default.a.createHmac(\"sha256\", _config__WEBPACK_IMPORTED_MODULE_1__[\"default\"].server.secret).update(plain).digest(\"hex\"); // console.log(\"signMessage\", plain, cipher);\n\n    return cipher;\n  }\n});\n\n//# sourceURL=webpack:///./core/myCrypto.js?");

/***/ }),

/***/ "./core/strings.js":
/*!*************************!*\
  !*** ./core/strings.js ***!
  \*************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _i18n_en__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./i18n/en */ \"./core/i18n/en.js\");\n/* harmony import */ var _i18n_ar__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./i18n/ar */ \"./core/i18n/ar.js\");\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  en: _i18n_en__WEBPACK_IMPORTED_MODULE_0__[\"default\"],\n  ar: _i18n_ar__WEBPACK_IMPORTED_MODULE_1__[\"default\"]\n});\n\n//# sourceURL=webpack:///./core/strings.js?");

/***/ }),

/***/ "./core/tracer.js":
/*!************************!*\
  !*** ./core/tracer.js ***!
  \************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var tracer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tracer */ \"tracer\");\n/* harmony import */ var tracer__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(tracer__WEBPACK_IMPORTED_MODULE_0__);\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (tracer__WEBPACK_IMPORTED_MODULE_0___default.a.colorConsole({\n  format: [\"{{timestamp}} {{file}}:{{line}} <{{title}}> {{message}}\", {\n    error: \"{{timestamp}} {{file}}:{{line}} <{{title}}> {{message}}\\nCall Stack:\\n{{stack}}\" // error format\n\n  }],\n  dateformat: \"HH:MM:ss.L\",\n  preprocess: data => {\n    data.title = data.title.toUpperCase();\n  }\n}));\n\n//# sourceURL=webpack:///./core/tracer.js?");

/***/ }),

/***/ "./routes/admin-api.js":
/*!*****************************!*\
  !*** ./routes/admin-api.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _admin_api_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./admin-api/auth */ \"./routes/admin-api/auth.js\");\n/* harmony import */ var _admin_api_profile__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./admin-api/profile */ \"./routes/admin-api/profile.js\");\n/* harmony import */ var _admin_api_posts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./admin-api/posts */ \"./routes/admin-api/posts.js\");\n/* harmony import */ var _admin_api_news__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./admin-api/news */ \"./routes/admin-api/news.js\");\n/* harmony import */ var _admin_api_video__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./admin-api/video */ \"./routes/admin-api/video.js\");\n/* harmony import */ var _admin_api_questionnaire__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./admin-api/questionnaire */ \"./routes/admin-api/questionnaire.js\");\n/* harmony import */ var _admin_api_vote__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./admin-api/vote */ \"./routes/admin-api/vote.js\");\n/* harmony import */ var _admin_api_users__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./admin-api/users */ \"./routes/admin-api/users.js\");\n\n\n\n\n\n\n\n\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.use(\"/auth\", _admin_api_auth__WEBPACK_IMPORTED_MODULE_1__[\"default\"]);\nrouter.use(\"/profile\", _admin_api_profile__WEBPACK_IMPORTED_MODULE_2__[\"default\"]);\nrouter.use(\"/posts\", _admin_api_posts__WEBPACK_IMPORTED_MODULE_3__[\"default\"]);\nrouter.use(\"/news\", _admin_api_news__WEBPACK_IMPORTED_MODULE_4__[\"default\"]);\nrouter.use(\"/video\", _admin_api_video__WEBPACK_IMPORTED_MODULE_5__[\"default\"]);\nrouter.use(\"/questionnaire\", _admin_api_questionnaire__WEBPACK_IMPORTED_MODULE_6__[\"default\"]);\nrouter.use(\"/vote\", _admin_api_vote__WEBPACK_IMPORTED_MODULE_7__[\"default\"]);\nrouter.use(\"/users\", _admin_api_users__WEBPACK_IMPORTED_MODULE_8__[\"default\"]);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/admin-api.js?");

/***/ }),

/***/ "./routes/admin-api/auth.js":
/*!**********************************!*\
  !*** ./routes/admin-api/auth.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_myCrypto__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/myCrypto */ \"./core/myCrypto.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\n\nconst signInProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_8__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_8__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_6__[\"default\"][lang];\n  const {\n    email,\n    password\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_2__[\"sprintf\"])(\"SELECT `email` FROM `%s` WHERE BINARY `email` = ? AND `allow` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].admins);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [email, 1]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.emailIsNotRegistered\n      });\n      return;\n    }\n\n    const hash = _core_myCrypto__WEBPACK_IMPORTED_MODULE_5__[\"default\"].hmacHex(password);\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_2__[\"sprintf\"])(\"SELECT U.* FROM `%s` U WHERE BINARY U.email = ? AND BINARY U.hash = ? AND `allow` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].admins);\n    rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [email, hash, 1]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.passwordIsIncorrect\n      });\n      return;\n    }\n\n    const user = rows[0];\n    const token = jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default.a.sign({\n      id: user[\"id\"],\n      email: user[\"email\"],\n      username: user[\"username\"]\n    }, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"session\"].secretAdmin, {// expiresIn: '5m',\n    });\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySignedIn,\n      data: {\n        user,\n        token\n      }\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst signUpProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_8__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_8__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_6__[\"default\"][lang];\n  const {\n    email,\n    password,\n    username,\n    role\n  } = req.body;\n  const hash = _core_myCrypto__WEBPACK_IMPORTED_MODULE_5__[\"default\"].hmacHex(password);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_2__[\"sprintf\"])(\"SELECT `email` FROM `%s` WHERE BINARY `email` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].admins);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [email]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.emailAlreadyRegistered\n      });\n      return;\n    }\n\n    const newRows = [[null, email, hash, username, role, 0]];\n    console.log(newRows);\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_2__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].admins);\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]); // sendVerificationEmail(email);\n\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullyRegistered\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/sign-in\", signInProc);\nrouter.post(\"/sign-up\", signUpProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/admin-api/auth.js?");

/***/ }),

/***/ "./routes/admin-api/news.js":
/*!**********************************!*\
  !*** ./routes/admin-api/news.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! uuid */ \"uuid\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(uuid__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var mkdirp__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! mkdirp */ \"mkdirp\");\n/* harmony import */ var mkdirp__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(mkdirp__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst _loadData = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  let {\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName FROM `%s` P JOIN `%s` U ON U.id = P.userId WHERE P.deletedDate = ? AND P.userId LIKE ? ORDER BY P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].news, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\", userId || \"%%\", start, pageSize]);\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `deletedDate` = '%s' AND `userId` LIKE '%s';\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].news, \"\", userId || \"%%\");\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, null);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst listProc = async (req, res, next) => {\n  _loadData(req, res, next);\n};\n\nconst saveProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id,\n    title,\n    description,\n    url,\n    file,\n    userId\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  const time = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"hh:MM TT\");\n  const timestamp = today.getTime();\n\n  if (!!id && (!file || file === \"null\")) {\n    const newRows = [[id || null, timestamp, userId, date, time, title, description, url, \"\", \"\"]];\n    let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `title` = VALUES(`title`), `description` = VALUES(`description`), `url` = VALUES(`url`);\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].news);\n\n    try {\n      let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [newRows]);\n      res.status(200).send({\n        result: langs.success,\n        message: langs.successfullySaved,\n        data: rows\n      });\n    } catch (err) {\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError,\n        err\n      });\n    }\n\n    return;\n  }\n\n  if (!file || file === \"null\") {\n    // res.status(200).send({\n    //   result: langs.error,\n    //   message: langs.unknownServerError,\n    // });\n    const newRows = [[null, timestamp, userId, date, time, title, description, url, \"\", \"\"]];\n    let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `title` = VALUES(`title`), `description` = VALUES(`description`), `url` = VALUES(`url`);\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].news);\n\n    try {\n      let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [newRows]);\n      res.status(200).send({\n        result: langs.success,\n        message: langs.successfullySaved,\n        data: rows\n      });\n    } catch (err) {\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError,\n        err\n      });\n    }\n\n    return;\n  }\n\n  const appDir = process.cwd();\n  const fileDir = path__WEBPACK_IMPORTED_MODULE_3___default.a.join(appDir, \"public\", _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].uploadPath.news);\n  const fileName = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"%s%s\", uuid__WEBPACK_IMPORTED_MODULE_4___default()(), path__WEBPACK_IMPORTED_MODULE_3___default.a.extname(file.path));\n  const filePath = path__WEBPACK_IMPORTED_MODULE_3___default.a.join(fileDir, fileName);\n  const writable = fs__WEBPACK_IMPORTED_MODULE_5___default.a.createWriteStream(filePath);\n  const media = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"%s/%s\", _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].uploadPath.news, fileName);\n  mkdirp__WEBPACK_IMPORTED_MODULE_6___default()(fileDir, () => {\n    file.on(\"end\", async e => {\n      const newRows = [[id || null, timestamp, userId, date, time, title, description, url, media, \"\"]];\n      let sql;\n      let rows;\n\n      if (id) {\n        sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].news);\n        rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [id]);\n\n        if (rows.length > 0) {\n          const oldFilename = path__WEBPACK_IMPORTED_MODULE_3___default.a.join(fileDir, path__WEBPACK_IMPORTED_MODULE_3___default.a.basename(rows[0][\"media\"]));\n          _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].debug(oldFilename);\n          fs__WEBPACK_IMPORTED_MODULE_5___default.a.unlink(oldFilename, e => {});\n        }\n      }\n\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `title` = VALUES(`title`), `description` = VALUES(`description`), `url` = VALUES(`url`), `media` = VALUES(`media`);\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].news);\n\n      try {\n        rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [newRows]);\n        res.status(200).send({\n          result: langs.success,\n          message: langs.successfullySaved,\n          data: rows\n        });\n      } catch (err) {\n        _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n        _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n        res.status(200).send({\n          result: langs.error,\n          message: langs.unknownServerError,\n          err\n        });\n      }\n    });\n    file.on(\"error\", err => {\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError,\n        err\n      });\n    });\n    file.pipe(writable);\n  });\n};\n\nconst deleteProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].news);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [date, id]);\n\n    _loadData(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName FROM `%s` P JOIN `%s` U ON U.id = P.userId WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].news, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst countProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].news);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\"]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError\n      });\n      return;\n    }\n\n    const row = rows[0];\n    res.status(200).send({\n      result: langs.success,\n      data: {\n        count: row.count\n      }\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/list\", listProc);\nrouter.post(\"/save\", saveProc);\nrouter.post(\"/delete\", deleteProc);\nrouter.post(\"/get\", getProc);\nrouter.post(\"/count\", countProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/admin-api/news.js?");

/***/ }),

/***/ "./routes/admin-api/posts.js":
/*!***********************************!*\
  !*** ./routes/admin-api/posts.js ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var mkdirp__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! mkdirp */ \"mkdirp\");\n/* harmony import */ var mkdirp__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(mkdirp__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! uuid */ \"uuid\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(uuid__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst _loadData = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  let {\n    page,\n    pageSize,\n    userId,\n    allowed,\n    topics\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  let allowedWhere = \"\";\n\n  if (allowed === 1) {\n    allowedWhere = \"AND P.allowedDate != ''\";\n  } else if (allowed === 0) {\n    allowedWhere = \"AND P.allowedDate = ''\";\n  }\n\n  let sql;\n  let rows;\n  let topicWhere = \"\";\n\n  if (!!topics && !!topics.length) {\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT `postId` FROM `%s` WHERE `topicId` IN (?) AND `related` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].post2Topics);\n    rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [topics, 1]);\n    let tmp = [];\n\n    for (let row of rows) {\n      tmp.push(row[\"postId\"]);\n    }\n\n    if (!!tmp.length) {\n      topicWhere = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"AND P.id IN (%s)\", tmp.join(\",\"));\n    } else {\n      topicWhere = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"AND P.id = '0'\");\n    }\n  }\n\n  sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName, IFNULL(C.comments, 0) `comments` FROM `%s` P JOIN `%s` U ON U.id = P.userId LEFT JOIN `%s` C ON C.postId = P.id WHERE P.deletedDate = ? AND P.userId LIKE ? %s %s ORDER BY P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].users, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].comments_count, allowedWhere, topicWhere);\n\n  try {\n    rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\", userId || \"%%\", start, pageSize]);\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(P.id) `count` FROM `%s` P WHERE P.deletedDate = ? AND P.userId LIKE ? %s %s;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts, allowedWhere, topicWhere);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\", userId || \"%%\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadTopics = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  let {\n    page,\n    pageSize\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultPageSize);\n  let start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `deletedDate` = ? ORDER BY `timestamp` ASC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].postTopics);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\", start, pageSize]);\n\n    for (let row of rows) {\n      row[\"number\"] = ++start;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].postTopics);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst listProc = async (req, res, next) => {\n  _loadData(req, res, next);\n};\n\nconst saveProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id,\n    title,\n    description,\n    file,\n    userId\n  } = req.body;\n\n  if (!!id && (!file || file === \"null\")) {\n    const newRows = [[id || null, 0, userId, \"\", \"\", title, description, \"\", \"\"]];\n    let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `title` = VALUES(`title`), `description` = VALUES(`description`);\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts);\n\n    try {\n      let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [newRows]);\n      res.status(200).send({\n        result: langs.success,\n        message: langs.successfullySaved,\n        data: rows\n      });\n    } catch (err) {\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError,\n        err\n      });\n    }\n\n    return;\n  }\n\n  if (!file || file === \"null\") {\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError\n    });\n    return;\n  }\n\n  const appDir = process.cwd();\n  const fileDir = path__WEBPACK_IMPORTED_MODULE_3___default.a.join(appDir, \"public\", _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].uploadPath.posts);\n  const fileName = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"%s%s\", uuid__WEBPACK_IMPORTED_MODULE_6___default()(), path__WEBPACK_IMPORTED_MODULE_3___default.a.extname(file.path));\n  const filePath = path__WEBPACK_IMPORTED_MODULE_3___default.a.join(fileDir, fileName);\n  const writable = fs__WEBPACK_IMPORTED_MODULE_5___default.a.createWriteStream(filePath);\n  const media = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"%s/%s\", _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].uploadPath.posts, fileName);\n  mkdirp__WEBPACK_IMPORTED_MODULE_4___default()(fileDir, () => {\n    file.on(\"end\", async e => {\n      const today = new Date();\n      const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n      const time = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"hh:MM TT\");\n      const timestamp = today.getTime();\n      const newRows = [[id || null, timestamp, userId, date, time, title, description, media, \"\"]];\n      let sql;\n      let rows;\n\n      if (id) {\n        sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts);\n        rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [id]);\n\n        if (rows.length > 0) {\n          const oldFilename = path__WEBPACK_IMPORTED_MODULE_3___default.a.join(fileDir, path__WEBPACK_IMPORTED_MODULE_3___default.a.basename(rows[0][\"media\"]));\n          _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].debug(oldFilename);\n          fs__WEBPACK_IMPORTED_MODULE_5___default.a.unlink(oldFilename, e => {});\n        }\n      }\n\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `title` = VALUES(`title`), `description` = VALUES(`description`), `media` = VALUES(`media`);\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts);\n\n      try {\n        rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [newRows]);\n        res.status(200).send({\n          result: langs.success,\n          message: langs.successfullySaved,\n          data: rows\n        });\n      } catch (err) {\n        _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n        _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n        res.status(200).send({\n          result: langs.error,\n          message: langs.unknownServerError,\n          err\n        });\n      }\n    });\n    file.on(\"error\", err => {\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError,\n        err\n      });\n    });\n    file.pipe(writable);\n  });\n};\n\nconst deleteProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [date, id]);\n\n    _loadData(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id,\n    userId\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName, C.userId `commentId` FROM `%s` P JOIN `%s` U ON U.id = P.userId LEFT JOIN `%s` C ON C.postId = P.id AND C.userId = ? WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].users, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].comments);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [userId || 0, id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst commentList = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    postId\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT C.*, U.firstName, U.lastName FROM `%s` C JOIN `%s` U ON U.id = C.userId WHERE C.postId = ? ORDER BY C.timestamp DESC;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].comments, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [postId]);\n    res.status(200).send({\n      result: langs.success,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst post2TopicsProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    postId\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT T.* FROM `%s` M JOIN `%s` T ON T.id = M.topicId WHERE M.postId = ?\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].post2Topics, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].postTopics);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [postId]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst allowProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id,\n    allow\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `allowedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [!!allow ? date : \"\", id]);\n\n    _loadData(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst denyProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const date = \"\";\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `allowedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [date, id]);\n\n    _loadData(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst countProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT (SELECT COUNT(`id`) FROM `%s` WHERE `deletedDate` = ?) `count`, (SELECT COUNT(`id`) FROM `%s` WHERE `allowedDate` = ? AND `deletedDate` = ?) `countAwaiting`;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\", \"\", \"\"]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError\n      });\n      return;\n    }\n\n    const row = rows[0];\n    res.status(200).send({\n      result: langs.success,\n      data: {\n        count: row.count,\n        countAwaiting: row.countAwaiting\n      }\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst topicsProc = async (req, res, next) => {\n  await _loadTopics(req, res, next);\n};\n\nconst saveTopicProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id,\n    topic\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  const time = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"hh:MM TT\");\n  const timestamp = today.getTime();\n  const newRows = [[id || null, timestamp, date, time, topic, \"\"]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `topic` = VALUES(`topic`);\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].postTopics);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst deleteTopicProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].postTopics);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [date, id]);\n\n    _loadTopics(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getTopicProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].postTopics);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/list\", listProc);\nrouter.post(\"/save\", saveProc);\nrouter.post(\"/delete\", deleteProc);\nrouter.post(\"/get\", getProc);\nrouter.post(\"/comment-list\", commentList);\nrouter.post(\"/post2topics\", post2TopicsProc);\nrouter.post(\"/allow\", allowProc);\nrouter.post(\"/count\", countProc); // router.post(\"/deny\", denyProc);\n\nrouter.post(\"/topics\", topicsProc);\nrouter.post(\"/save-topic\", saveTopicProc);\nrouter.post(\"/delete-topic\", deleteTopicProc);\nrouter.post(\"/get-topic\", getTopicProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/admin-api/posts.js?");

/***/ }),

/***/ "./routes/admin-api/profile.js":
/*!*************************************!*\
  !*** ./routes/admin-api/profile.js ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n/* harmony import */ var _core_myCrypto__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/myCrypto */ \"./core/myCrypto.js\");\n\n\n\n\n\n\n\n\n\n\nconst saveProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    id,\n    email,\n    username\n  } = req.body;\n  const newRows = [[id, email, \"\", username, \"\", 0]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `email` = VALUES(`email`), `username` = VALUES(`username`);\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].admins);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]);\n    const token = jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default.a.sign({\n      id: id,\n      email: email,\n      username: username\n    }, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"session\"].secret);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: {\n        user: {\n          id,\n          email,\n          username\n        },\n        token\n      }\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst changePasswordProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    id,\n    password0,\n    password\n  } = req.body;\n  const hash0 = _core_myCrypto__WEBPACK_IMPORTED_MODULE_8__[\"default\"].hmacHex(password0 || \"\");\n  const hash = _core_myCrypto__WEBPACK_IMPORTED_MODULE_8__[\"default\"].hmacHex(password || \"\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `id` = ? AND `hash` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].admins);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id, hash0]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.currentPasswordIncorrect\n      });\n      return;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `hash` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].admins);\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [hash, id]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullyChanged\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/save\", saveProc);\nrouter.post(\"/change-password\", changePasswordProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/admin-api/profile.js?");

/***/ }),

/***/ "./routes/admin-api/questionnaire.js":
/*!*******************************************!*\
  !*** ./routes/admin-api/questionnaire.js ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\nconst _loadPackages = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.deletedDate = ? ORDER BY P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\", start, pageSize]);\n    let number = start + 1;\n\n    for (let row of rows) {\n      row['number'] = number++;\n      row[\"ended\"] = row[\"endDate\"] < date;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadQuestions = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    packageId,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.packageId = ? AND P.deletedDate = ? ORDER BY P.timestamp ASC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\", start, pageSize]);\n    let number = start + 1;\n\n    for (let row of rows) {\n      row['number'] = number++;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `packageId` = ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadAnswers = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    questionId,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.questionId = ? AND P.deletedDate = ? ORDER BY P.timestamp ASC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireAnswers);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [questionId, \"\", start, pageSize]);\n    let number = start + 1;\n\n    for (let row of rows) {\n      row['number'] = number++;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `questionId` = ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireAnswers);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [questionId, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadResult = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    packageId,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT Q.*, C.count `answersCount` FROM `%s` Q LEFT JOIN `%s` C ON C.questionId = Q.id WHERE Q.packageId = ? AND Q.deletedDate = ? ORDER BY Q.timestamp ASC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireAnsweredCount);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\", start, pageSize]);\n    let rows1;\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `packageId` = ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0][\"count\"] / pageSize));\n    let index = start + 1;\n\n    for (let row of rows) {\n      row[\"index\"] = index++;\n      row[\"isEnded\"] = row[\"endDate\"] < date;\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT A.id, A.answer, IFNULL(C.count, 0) `count` FROM `%s` A LEFT JOIN `%s` C ON C.answerId = A.id WHERE A.questionId = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireAnswers, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireResultCount);\n      row[\"answers\"] = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [row.id]);\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`questionId`) `count` FROM `%s` WHERE `questionId` = ? AND `userId` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireResult);\n      rows1 = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [row.id, userId]);\n      row[\"answered\"] = !!rows1[0][\"count\"];\n    }\n\n    res.status(200).send({\n      result: langs.success,\n      count: count[0][\"count\"],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst packagesProc = async (req, res, next) => {\n  _loadPackages(req, res, next);\n};\n\nconst savePackageProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    name,\n    startDate,\n    endDate,\n    userId\n  } = req.body;\n  const today = new Date();\n  const timestamp = today.getTime();\n  const newRows = [[id || null, timestamp, name, startDate, endDate, \"\", \"\"]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `name` = VALUES(`name`), `startDate` = VALUES(`startDate`), `endDate` = VALUES(`endDate`);\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst deletePackageProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, id]);\n\n    _loadPackages(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getPackageProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: { ...rows[0],\n          today: dateformat__WEBPACK_IMPORTED_MODULE_2___default()(new Date(), \"yyyy-mm-dd\")\n        }\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst questionsProc = async (req, res, next) => {\n  _loadQuestions(req, res, next);\n};\n\nconst saveQuestionProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    packageId,\n    question,\n    userId\n  } = req.body;\n  const today = new Date();\n  const timestamp = today.getTime();\n  const newRows = [[id || null, packageId, timestamp, question, \"\", \"\"]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `question` = VALUES(`question`);\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst deleteQuestionProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, id]);\n\n    _loadQuestions(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getQuestionProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst answersProc = async (req, res, next) => {\n  _loadAnswers(req, res, next);\n};\n\nconst saveAnswerProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    questionId,\n    answer,\n    userId\n  } = req.body;\n  const today = new Date();\n  const timestamp = today.getTime();\n  const newRows = [[id || null, timestamp, questionId, answer, \"\"]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `answer` = VALUES(`answer`);\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireAnswers);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst deleteAnswerProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireAnswers);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, id]);\n\n    _loadAnswers(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getAnswerProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireAnswers);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst resultProc = async (req, res, next) => {\n  _loadResult(req, res, next);\n};\n\nconst publishProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    release\n  } = req.body;\n  const today = new Date();\n  const date = release ? dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\") : \"\";\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `releasedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, id]);\n    getPackageProc(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst countProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT (SELECT COUNT(`id`) FROM `%s` WHERE `deletedDate` = ?) `count`, (SELECT COUNT(`id`) FROM `%s` WHERE `deletedDate` = ? AND `releasedDate` = ? AND `endDate` > ?) `countAwaiting`;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\", \"\", \"\", date]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError\n      });\n      return;\n    }\n\n    const row = rows[0];\n    res.status(200).send({\n      result: langs.success,\n      data: {\n        count: row.count,\n        countAwaiting: row.countAwaiting\n      }\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/packages\", packagesProc);\nrouter.post(\"/save-package\", savePackageProc);\nrouter.post(\"/delete-package\", deletePackageProc);\nrouter.post(\"/get-package\", getPackageProc);\nrouter.post(\"/questions\", questionsProc);\nrouter.post(\"/save-question\", saveQuestionProc);\nrouter.post(\"/delete-question\", deleteQuestionProc);\nrouter.post(\"/get-question\", getQuestionProc);\nrouter.post(\"/answers\", answersProc);\nrouter.post(\"/save-answer\", saveAnswerProc);\nrouter.post(\"/delete-answer\", deleteAnswerProc);\nrouter.post(\"/get-answer\", getAnswerProc);\nrouter.post(\"/result\", resultProc);\nrouter.post(\"/publish\", publishProc);\nrouter.post(\"/count\", countProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/admin-api/questionnaire.js?");

/***/ }),

/***/ "./routes/admin-api/users.js":
/*!***********************************!*\
  !*** ./routes/admin-api/users.js ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\nconst _loadData = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    page,\n    pageSize,\n    userId,\n    scope,\n    search\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  search = `%${search}%`;\n  let allowedWhere = \"\";\n\n  if (scope === \"new\") {\n    allowedWhere = \"AND `allowedDate` = ''\";\n  }\n\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `deletedDate` = ? AND (`email` LIKE ? OR `username` LIKE ? AND `firstName` LIKE ? AND `lastName` LIKE ? AND `jobTitle` LIKE ? AND `sector` LIKE ? AND `company` LIKE ? AND `city` LIKE ? AND `phone` LIKE ?) %s ORDER BY `createdDate` DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users, allowedWhere); // let sql = sprintf(\"SELECT * FROM `%s` WHERE `deletedDate` = ? %s ORDER BY LENGTH(`allowedDate`) ASC, `createdDate` DESC LIMIT ?, ?;\", dbTblName.users, allowedWhere);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\", search, search, search, search, search, search, search, search, search, start, pageSize]);\n    let number = start + 1;\n\n    for (let row of rows) {\n      row[\"number\"] = number++;\n      row[\"gender\"] = row[\"gender\"] === _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].male ? langs.male : langs.female;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `deletedDate` = ? AND (`email` LIKE ? OR `username` LIKE ? AND `firstName` LIKE ? AND `lastName` LIKE ? AND `jobTitle` LIKE ? AND `sector` LIKE ? AND `company` LIKE ? AND `city` LIKE ? AND `phone` LIKE ?) %s;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users, allowedWhere);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\", search, search, search, search, search, search, search, search, search]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst listProc = async (req, res, next) => {\n  _loadData(req, res, next);\n};\n\nconst allowProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    allow\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `allowedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [!!allow ? date : \"\", id]);\n\n    _loadData(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst deleteProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, id]);\n\n    _loadData(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst saveProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    email,\n    username,\n    firstName,\n    lastName,\n    gender,\n    birthday,\n    jobTitle,\n    sector,\n    company,\n    city,\n    phone\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `email` = ?, `username` = ?, `firstName` = ?, `lastName` = ?, `gender` = ?, `birthday` = ?, `jobTitle` = ?, `sector` = ?, `company` = ?, `city` = ?, `phone` = ?, `modifiedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [email, username, firstName, lastName, gender, birthday, jobTitle, sector, company, city, phone, date, id]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n      return;\n    }\n\n    const row = rows[0];\n    res.status(200).send({\n      result: langs.success,\n      data: row\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst countProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT (SELECT COUNT(`id`) FROM `%s` WHERE `deletedDate` = ?) `count`, (SELECT COUNT(`id`) FROM `%s` WHERE `allowedDate` = ? AND `deletedDate` = ?) `countAwaiting`;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\", \"\", \"\"]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n      return;\n    }\n\n    const row = rows[0];\n    res.status(200).send({\n      result: langs.success,\n      data: {\n        count: row.count,\n        countAwaiting: row.countAwaiting\n      }\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst signInHistoryProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    days\n  } = req.body;\n  const today = new Date();\n  const before = new Date(today.getTime() - (days || 15) * 24 * 3600000);\n  const startDate = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(before, \"yyyy-mm-dd\");\n  const endDate = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT `date`, COUNT(`date`) `count` FROM `%s` WHERE `date` BETWEEN ? AND ? GROUP BY `date` ORDER BY `date` ASC;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].usersSigninHistory);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [startDate, endDate]);\n\n    for (let row of rows) {\n      // row[\"date\"] = sprintf(\"%s GMT\", dateformat(new Date(row[\"date\"]), \"mm-dd-yyyy\"));\n      row[\"date\"] = new Date(row[\"date\"]).getTime();\n    }\n\n    res.status(200).send({\n      result: langs.success,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst countPerGenderProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT `gender`, COUNT(`id`) `count` FROM `%s` GROUP BY `gender`;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql);\n    res.status(200).send({\n      result: langs.success,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/list\", listProc);\nrouter.post(\"/allow\", allowProc);\nrouter.post(\"/delete\", deleteProc);\nrouter.post(\"/get\", getProc);\nrouter.post(\"/save\", saveProc);\nrouter.post(\"/count\", countProc);\nrouter.post(\"/sign-in-history\", signInHistoryProc);\nrouter.post(\"/count-per-gender\", countPerGenderProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/admin-api/users.js?");

/***/ }),

/***/ "./routes/admin-api/video.js":
/*!***********************************!*\
  !*** ./routes/admin-api/video.js ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\nconst _loadData = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName FROM `%s` P JOIN `%s` U ON U.id = P.userId WHERE P.deletedDate = ? AND P.userId LIKE ? ORDER BY P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].video, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\", userId || \"%%\", start, pageSize]);\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `deletedDate` = '%s' AND `userId` LIKE '%s';\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].video, \"\", userId || \"%%\");\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, null);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst listProc = async (req, res, next) => {\n  _loadData(req, res, next);\n};\n\nconst saveProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    title,\n    url,\n    isFile,\n    userId\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  const time = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"hh:MM TT\");\n  const timestamp = today.getTime();\n  const newRows = [[id || null, timestamp, userId, date, time, title, url, isFile, \"\"]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `title` = VALUES(`title`), `url` = VALUES(`url`), `isFile` = VALUES(`isFile`);\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].video);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst deleteProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].video);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, id]);\n\n    _loadData(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName FROM `%s` P JOIN `%s` U ON U.id = P.userId WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].video, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst countProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].video);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\"]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError\n      });\n      return;\n    }\n\n    const row = rows[0];\n    res.status(200).send({\n      result: langs.success,\n      data: {\n        count: row.count\n      }\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/list\", listProc);\nrouter.post(\"/save\", saveProc);\nrouter.post(\"/delete\", deleteProc);\nrouter.post(\"/get\", getProc);\nrouter.post(\"/count\", countProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/admin-api/video.js?");

/***/ }),

/***/ "./routes/admin-api/vote.js":
/*!**********************************!*\
  !*** ./routes/admin-api/vote.js ***!
  \**********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\nconst _loadPackages = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.deletedDate = ? ORDER BY P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\", start, pageSize]);\n    let number = start + 1;\n\n    for (let row of rows) {\n      row['number'] = number++;\n      row[\"ended\"] = row[\"endDate\"] < date;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadQuestions = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    packageId,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.packageId = ? AND P.deletedDate = ? ORDER BY P.timestamp ASC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\", start, pageSize]);\n    let number = start + 1;\n\n    for (let row of rows) {\n      row['number'] = number++;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `packageId` = ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadAnswers = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    questionId,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.questionId = ? AND P.deletedDate = ? ORDER BY P.timestamp ASC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteAnswers);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [questionId, \"\", start, pageSize]);\n    let number = start + 1;\n\n    for (let row of rows) {\n      row['number'] = number++;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `questionId` = ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteAnswers);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [questionId, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadResult = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    packageId,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `packageId` = ? AND `deletedDate` = ? ORDER BY `timestamp` ASC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\", start, pageSize]);\n    let rows1;\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `packageId` = ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0][\"count\"] / pageSize));\n    let index = start + 1;\n\n    for (let row of rows) {\n      row[\"index\"] = index++;\n      row[\"isEnded\"] = row[\"endDate\"] < date;\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT A.id, A.answer, IFNULL(C.count, 0) `count` FROM `%s` A LEFT JOIN `%s` C ON C.answerId = A.id WHERE A.questionId = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteAnswers, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteResultCount);\n      row[\"answers\"] = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [row.id]);\n      row[\"answersCount\"] = 0;\n\n      for (let item of row[\"answers\"]) {\n        row[\"answersCount\"] += item.count;\n      }\n\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`questionId`) `count` FROM `%s` WHERE `questionId` = ? AND `userId` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteResult);\n      rows1 = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [row.id, userId]);\n      row[\"answered\"] = !!rows1[0][\"count\"];\n    }\n\n    res.status(200).send({\n      result: langs.success,\n      count: count[0][\"count\"],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst packagesProc = async (req, res, next) => {\n  _loadPackages(req, res, next);\n};\n\nconst savePackageProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    name,\n    startDate,\n    endDate,\n    userId\n  } = req.body;\n  const today = new Date();\n  const timestamp = today.getTime();\n  const newRows = [[id || null, timestamp, name, startDate, endDate, \"\", \"\"]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `name` = VALUES(`name`), `startDate` = VALUES(`startDate`), `endDate` = VALUES(`endDate`);\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst deletePackageProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, id]);\n\n    _loadPackages(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getPackageProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: { ...rows[0],\n          today: dateformat__WEBPACK_IMPORTED_MODULE_2___default()(new Date(), \"yyyy-mm-dd\")\n        }\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst questionsProc = async (req, res, next) => {\n  _loadQuestions(req, res, next);\n};\n\nconst saveQuestionProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    packageId,\n    question,\n    userId\n  } = req.body;\n  const today = new Date();\n  const timestamp = today.getTime();\n  const newRows = [[id || null, packageId, timestamp, question, \"\", \"\"]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `question` = VALUES(`question`);\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst deleteQuestionProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, id]);\n\n    _loadQuestions(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getQuestionProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst answersProc = async (req, res, next) => {\n  _loadAnswers(req, res, next);\n};\n\nconst saveAnswerProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    questionId,\n    answer,\n    userId\n  } = req.body;\n  const today = new Date();\n  const timestamp = today.getTime();\n  const newRows = [[id || null, timestamp, questionId, answer, \"\"]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `answer` = VALUES(`answer`);\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteAnswers);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst deleteAnswerProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteAnswers);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, id]);\n\n    _loadAnswers(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getAnswerProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteAnswers);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst resultProc = async (req, res, next) => {\n  _loadResult(req, res, next);\n};\n\nconst publishProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    release\n  } = req.body;\n  const today = new Date();\n  const date = release ? dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\") : \"\";\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `releasedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, id]);\n    getPackageProc(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst countProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT (SELECT COUNT(`id`) FROM `%s` WHERE `deletedDate` = ?) `count`, (SELECT COUNT(`id`) FROM `%s` WHERE `deletedDate` = ? AND `releasedDate` = ? AND `endDate` > ?) `countAwaiting`;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\", \"\", \"\", date]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError\n      });\n      return;\n    }\n\n    const row = rows[0];\n    res.status(200).send({\n      result: langs.success,\n      data: {\n        count: row.count,\n        countAwaiting: row.countAwaiting\n      }\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/packages\", packagesProc);\nrouter.post(\"/save-package\", savePackageProc);\nrouter.post(\"/delete-package\", deletePackageProc);\nrouter.post(\"/get-package\", getPackageProc);\nrouter.post(\"/questions\", questionsProc);\nrouter.post(\"/save-question\", saveQuestionProc);\nrouter.post(\"/delete-question\", deleteQuestionProc);\nrouter.post(\"/get-question\", getQuestionProc);\nrouter.post(\"/answers\", answersProc);\nrouter.post(\"/save-answer\", saveAnswerProc);\nrouter.post(\"/delete-answer\", deleteAnswerProc);\nrouter.post(\"/get-answer\", getAnswerProc);\nrouter.post(\"/result\", resultProc);\nrouter.post(\"/publish\", publishProc);\nrouter.post(\"/count\", countProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/admin-api/vote.js?");

/***/ }),

/***/ "./routes/api.js":
/*!***********************!*\
  !*** ./routes/api.js ***!
  \***********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _api_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./api/auth */ \"./routes/api/auth.js\");\n/* harmony import */ var _api_profile__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./api/profile */ \"./routes/api/profile.js\");\n/* harmony import */ var _api_posts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./api/posts */ \"./routes/api/posts.js\");\n/* harmony import */ var _api_news__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./api/news */ \"./routes/api/news.js\");\n/* harmony import */ var _api_video__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./api/video */ \"./routes/api/video.js\");\n/* harmony import */ var _api_questionnaire__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./api/questionnaire */ \"./routes/api/questionnaire.js\");\n/* harmony import */ var _api_vote__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./api/vote */ \"./routes/api/vote.js\");\n/* harmony import */ var _api_contact__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./api/contact */ \"./routes/api/contact.js\");\n\n\n\n\n\n\n\n\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.use(\"/auth\", _api_auth__WEBPACK_IMPORTED_MODULE_1__[\"default\"]);\nrouter.use(\"/profile\", _api_profile__WEBPACK_IMPORTED_MODULE_2__[\"default\"]);\nrouter.use(\"/posts\", _api_posts__WEBPACK_IMPORTED_MODULE_3__[\"default\"]);\nrouter.use(\"/news\", _api_news__WEBPACK_IMPORTED_MODULE_4__[\"default\"]);\nrouter.use(\"/video\", _api_video__WEBPACK_IMPORTED_MODULE_5__[\"default\"]);\nrouter.use(\"/questionnaire\", _api_questionnaire__WEBPACK_IMPORTED_MODULE_6__[\"default\"]);\nrouter.use(\"/vote\", _api_vote__WEBPACK_IMPORTED_MODULE_7__[\"default\"]);\nrouter.use(\"/contact\", _api_contact__WEBPACK_IMPORTED_MODULE_8__[\"default\"]);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/api.js?");

/***/ }),

/***/ "./routes/api/auth.js":
/*!****************************!*\
  !*** ./routes/api/auth.js ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_myCrypto__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/myCrypto */ \"./core/myCrypto.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\n\n\nconst signInProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_9__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_9__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_7__[\"default\"][lang];\n  const {\n    email,\n    password\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_2__[\"sprintf\"])(\"SELECT `email` FROM `%s` WHERE `email` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_4__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_5__[\"default\"].query(sql, [email]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.emailIsNotRegistered\n      });\n      return;\n    }\n\n    const hash = _core_myCrypto__WEBPACK_IMPORTED_MODULE_6__[\"default\"].hmacHex(password);\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_2__[\"sprintf\"])(\"SELECT U.* FROM `%s` U WHERE U.email = ? AND BINARY U.hash = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_4__[\"dbTblName\"].users);\n    rows = await _core_db__WEBPACK_IMPORTED_MODULE_5__[\"default\"].query(sql, [email, hash]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.passwordIsIncorrect\n      });\n      return;\n    }\n\n    const user = rows[0];\n\n    if (user.deletedDate.length > 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.yourAccountIsClosed\n      });\n      return;\n    }\n\n    if (user.allowedDate.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.yourAccountIsNotAllowed\n      });\n      return;\n    }\n\n    const token = jsonwebtoken__WEBPACK_IMPORTED_MODULE_1___default.a.sign({\n      id: user[\"id\"],\n      email: user[\"email\"],\n      firstName: user[\"firstName\"],\n      lastName: user[\"lastName\"]\n    }, _core_config__WEBPACK_IMPORTED_MODULE_4__[\"session\"].secret);\n    const today = new Date();\n    const date = dateformat__WEBPACK_IMPORTED_MODULE_3___default()(today, \"yyyy-mm-dd\");\n    const time = dateformat__WEBPACK_IMPORTED_MODULE_3___default()(today, \"hh:MM TT\");\n    const timestamp = today.getTime();\n    const remoteAddress = req.header[\"x-forwarded-for\"] || req.connection.remoteAddress;\n    const newRows = [[null, user.id, timestamp, date, time, remoteAddress]];\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_2__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ?;\", _core_config__WEBPACK_IMPORTED_MODULE_4__[\"dbTblName\"].usersSigninHistory);\n    await _core_db__WEBPACK_IMPORTED_MODULE_5__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySignedIn,\n      data: {\n        user,\n        token\n      }\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_8__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_8__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst signUpProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_9__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_9__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_7__[\"default\"][lang];\n  const {\n    email,\n    password,\n    username,\n    firstName,\n    lastName,\n    gender,\n    birthday,\n    jobTitle,\n    sector,\n    company,\n    city,\n    phone\n  } = req.body;\n  const hash = _core_myCrypto__WEBPACK_IMPORTED_MODULE_6__[\"default\"].hmacHex(password);\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_3___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_2__[\"sprintf\"])(\"SELECT `email` FROM `%s` WHERE `email` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_4__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_5__[\"default\"].query(sql, [email]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.emailAlreadyRegistered\n      });\n      return;\n    }\n\n    const newRows = [[null, email, hash, username, firstName, lastName, gender, birthday, jobTitle, sector, company, city, phone, 0, 0, date, date, \"\", \"\"]];\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_2__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ?;\", _core_config__WEBPACK_IMPORTED_MODULE_4__[\"dbTblName\"].users);\n    await _core_db__WEBPACK_IMPORTED_MODULE_5__[\"default\"].query(sql, [newRows]); // sendVerificationEmail(email);\n\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullyRegistered\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_8__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_8__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/sign-in\", signInProc);\nrouter.post(\"/sign-up\", signUpProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/api/auth.js?");

/***/ }),

/***/ "./routes/api/contact.js":
/*!*******************************!*\
  !*** ./routes/api/contact.js ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var request__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! request */ \"request\");\n/* harmony import */ var request__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(request__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\n\nconst usProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_8__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_8__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_6__[\"default\"][lang];\n  let {\n    name,\n    email,\n    subject,\n    message\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  const time = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"hh:MM TT\");\n  const timestamp = today.getTime();\n  const newRows = [[null, timestamp, date, time, name, email, subject, message]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ?;\", _core_config__WEBPACK_IMPORTED_MODULE_4__[\"dbTblName\"].contactUs);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_5__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySent\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst consultantsProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_8__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_8__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_6__[\"default\"][lang]; //\n  // let sql = sprintf(\"SELECT * FROM `%s`.`%s` ;\", dbTblName.eliteResourcesDb, dbTblName.consultants);\n  //\n  // try {\n  //   let rows = await db.query(sql);\n  //\n  //   for (let row of rows) {\n  //     row[\"media\"] = `${consts.eliteResourcesUrl}/assets${row[\"media\"]}`;\n  //   }\n  //\n  //   res.status(200).send({\n  //     result: langs.success,\n  //     data: rows,\n  //   });\n  // } catch (err) {\n  //   tracer.error(JSON.stringify(err));\n  //   tracer.error(__filename);\n  //   res.status(200).send({\n  //     result: langs.error,\n  //     message: langs.unknownServerError,\n  //     err,\n  //   });\n  // }\n\n  const headers = {\n    \"content-type\": \"application/json\",\n    \"Accept\": \"application/json\",\n    \"X-Requested-With\": \"XMLHttpRequest\",\n    \"language\": lang\n  };\n  const requestOptions = {\n    headers: headers,\n    method: \"POST\",\n    url: \"https://eliteresources.co/api/director-board/list\"\n  };\n  request__WEBPACK_IMPORTED_MODULE_3___default()(requestOptions, (err, response, body) => {\n    if (!!err) {\n      _core_tracer__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error(JSON.stringify(err));\n      _core_tracer__WEBPACK_IMPORTED_MODULE_7__[\"default\"].error(__filename);\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError\n      });\n    } else {\n      const rows = JSON.parse(body).data;\n\n      for (let row of rows) {\n        row[\"media\"] = `${_core_consts__WEBPACK_IMPORTED_MODULE_8__[\"default\"].eliteResourcesUrl}/assets${row[\"media\"]}`;\n      }\n\n      res.status(200).send({\n        result: langs.success,\n        data: rows\n      });\n    }\n  });\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/us\", usProc);\nrouter.post(\"/consultants\", consultantsProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/api/contact.js?");

/***/ }),

/***/ "./routes/api/news.js":
/*!****************************!*\
  !*** ./routes/api/news.js ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\nconst listProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_6__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_6__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_4__[\"default\"][lang];\n  let {\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_6__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName FROM `%s` P JOIN `%s` U ON U.id = P.userId WHERE P.deletedDate = ? AND P.userId LIKE ? ORDER BY P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_2__[\"dbTblName\"].news, _core_config__WEBPACK_IMPORTED_MODULE_2__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query(sql, [\"\", userId || \"%%\", start, pageSize]);\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `deletedDate` = '%s' AND `userId` LIKE '%s';\", _core_config__WEBPACK_IMPORTED_MODULE_2__[\"dbTblName\"].news, \"\", userId || \"%%\");\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query(sql, null);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_5__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_5__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst latestProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_6__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_6__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_4__[\"default\"][lang];\n  let {\n    limit\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName FROM `%s` P JOIN `%s` U ON U.id = P.userId WHERE P.deletedDate = ? ORDER BY P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_2__[\"dbTblName\"].news, _core_config__WEBPACK_IMPORTED_MODULE_2__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query(sql, [\"\", 0, limit]);\n    res.status(200).send({\n      result: langs.success,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_5__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_5__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_6__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_6__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_4__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName FROM `%s` P JOIN `%s` U ON U.id = P.userId WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_2__[\"dbTblName\"].news, _core_config__WEBPACK_IMPORTED_MODULE_2__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_3__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_5__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_5__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/list\", listProc);\nrouter.post(\"/latest\", latestProc);\nrouter.post(\"/get\", getProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/api/news.js?");

/***/ }),

/***/ "./routes/api/posts.js":
/*!*****************************!*\
  !*** ./routes/api/posts.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var mkdirp__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! mkdirp */ \"mkdirp\");\n/* harmony import */ var mkdirp__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(mkdirp__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! uuid */ \"uuid\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(uuid__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst _loadData = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  let {\n    page,\n    pageSize,\n    userId,\n    topics\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  let sql;\n  let rows;\n  let topicWhere = \"\";\n\n  if (!!topics && !!topics.length) {\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT `postId` FROM `%s` WHERE `topicId` IN (?) AND `related` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].post2Topics);\n    rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [topics, 1]);\n    let tmp = [];\n\n    for (let row of rows) {\n      tmp.push(row[\"postId\"]);\n    }\n\n    if (!!tmp.length) {\n      topicWhere = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"AND P.id IN (%s)\", tmp.join(\",\"));\n    } else {\n      topicWhere = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"AND P.id = '0'\");\n    }\n  }\n\n  sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName, IFNULL(C.comments, 0) `comments` FROM `%s` P JOIN `%s` U ON U.id = P.userId LEFT JOIN `%s` C ON C.postId = P.id WHERE P.deletedDate = ? AND P.userId LIKE ? AND P.allowedDate != ? %s ORDER BY P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].users, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].comments_count, topicWhere);\n\n  try {\n    rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\", userId || \"%%\", \"\", start, pageSize]);\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(P.id) `count` FROM `%s` P WHERE P.deletedDate = ? AND P.userId LIKE ? AND P.allowedDate != ? %s;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts, topicWhere);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\", userId || \"%%\", \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadTopics = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  let {\n    page,\n    pageSize\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultPageSize);\n  let start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `deletedDate` = ? ORDER BY `timestamp` ASC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].postTopics);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\", start, pageSize]);\n\n    for (let row of rows) {\n      row[\"number\"] = ++start;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].postTopics);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst listProc = async (req, res, next) => {\n  _loadData(req, res, next);\n};\n\nconst latestProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  let {\n    limit\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName, IFNULL(C.comments, 0) `comments` FROM `%s` P JOIN `%s` U ON U.id = P.userId LEFT JOIN `%s` C ON C.postId = P.id WHERE P.deletedDate = ? AND P.allowedDate = ? ORDER BY P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].users, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].comments_count);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [\"\", \"\", 0, limit]);\n    res.status(200).send({\n      result: langs.success,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst saveProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id,\n    topicIds,\n    title,\n    description,\n    file,\n    userId\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  const time = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"hh:MM TT\");\n  const timestamp = today.getTime();\n\n  if (!!id && (!file || file === \"null\")) {\n    let newRows = [[id || null, topicIds, 0, userId, \"\", \"\", title, description, \"\", \"\", \"\"]];\n    let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `topicIds` = VALUES(`topicIds`), `title` = VALUES(`title`), `description` = VALUES(`description`);\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts);\n\n    try {\n      let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [newRows]);\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `related` = ? WHERE `postId` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].post2Topics);\n      await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [0, id || 0]);\n      newRows = [];\n      const topicIdsArr = topicIds.split(\",\");\n\n      for (let topicId of topicIdsArr) {\n        newRows.push([id, topicId, 1]);\n      }\n\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `related` = VALUES(`related`);\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].post2Topics);\n      await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [newRows]);\n      res.status(200).send({\n        result: langs.success,\n        message: langs.successfullySaved,\n        data: rows\n      });\n    } catch (err) {\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError,\n        err\n      });\n    }\n\n    return;\n  }\n\n  if (!file || file === \"null\") {\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError\n    });\n    return;\n  }\n\n  const appDir = process.cwd();\n  const fileDir = path__WEBPACK_IMPORTED_MODULE_3___default.a.join(appDir, \"public\", _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].uploadPath.posts);\n  const fileName = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"%s%s\", uuid__WEBPACK_IMPORTED_MODULE_6___default()(), path__WEBPACK_IMPORTED_MODULE_3___default.a.extname(file.path));\n  const filePath = path__WEBPACK_IMPORTED_MODULE_3___default.a.join(fileDir, fileName);\n  const writable = fs__WEBPACK_IMPORTED_MODULE_5___default.a.createWriteStream(filePath);\n  const media = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"%s/%s\", _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].uploadPath.posts, fileName);\n  mkdirp__WEBPACK_IMPORTED_MODULE_4___default()(fileDir, () => {\n    file.on(\"end\", async e => {\n      let newRows = [[id || null, topicIds, timestamp, userId, date, time, title, description, media, \"\", \"\"]];\n      let sql;\n      let rows;\n\n      if (id) {\n        sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts);\n        rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [id]);\n\n        if (rows.length > 0) {\n          const oldFilename = path__WEBPACK_IMPORTED_MODULE_3___default.a.join(fileDir, path__WEBPACK_IMPORTED_MODULE_3___default.a.basename(rows[0][\"media\"]));\n          _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].debug(oldFilename);\n          fs__WEBPACK_IMPORTED_MODULE_5___default.a.unlink(oldFilename, e => {});\n        }\n      }\n\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `topicIds` = VALUES(`topicIds`), `title` = VALUES(`title`), `description` = VALUES(`description`), `media` = VALUES(`media`);\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts);\n\n      try {\n        rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [newRows]);\n        sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `related` = ? WHERE `postId` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].post2Topics);\n        await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [0, id || 0]);\n        newRows = [];\n        const topicIdsArr = topicIds.split(\",\");\n\n        for (let topicId of topicIdsArr) {\n          newRows.push([id || rows.insertId, topicId, 1]);\n        }\n\n        sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `related` = VALUES(`related`);\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].post2Topics);\n        await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [newRows]);\n        res.status(200).send({\n          result: langs.success,\n          message: langs.successfullySaved,\n          data: rows\n        });\n      } catch (err) {\n        _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n        _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n        res.status(200).send({\n          result: langs.error,\n          message: langs.unknownServerError,\n          err\n        });\n      }\n    });\n    file.on(\"error\", err => {\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n      _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError,\n        err\n      });\n    });\n    file.pipe(writable);\n  });\n};\n\nconst getProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    id,\n    userId\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName, C.userId `commentId` FROM `%s` P JOIN `%s` U ON U.id = P.userId LEFT JOIN `%s` C ON C.postId = P.id AND C.userId = ? WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].posts, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].users, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].comments);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [userId || 0, id]);\n\n    if (rows.length > 0) {\n      let row = rows[0]; // const topicIds = row[\"topicIds\"].split(\",\");\n      // tracer.info(\"topicIds\", row[\"topicIds\"], topicIds);\n      // sql = sprintf(\"SELECT * FROM `%s` WHERE `id` IN (?);\", dbTblName.postTopics);\n      // row[\"topics\"] = !!topicIds.length ? await db.query(sql, [topicIds]) : [];\n\n      res.status(200).send({\n        result: langs.success,\n        data: row\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst commentList = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    postId\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT C.*, U.firstName, U.lastName FROM `%s` C JOIN `%s` U ON U.id = C.userId WHERE C.postId = ? ORDER BY C.timestamp DESC;\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].comments, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [postId]);\n    res.status(200).send({\n      result: langs.success,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst writeComment = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    commentId,\n    userId,\n    comment\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  const time = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"hh:MM TT\");\n  const timestamp = today.getTime();\n  const newRows = [[commentId, userId, timestamp, date, time, comment, \"\"]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE comment = VALUES(`comment`);\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].comments);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst post2TopicsProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_11__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_9__[\"default\"][lang];\n  const {\n    postId\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT T.* FROM `%s` M JOIN `%s` T ON T.id = M.topicId WHERE M.postId = ?\", _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].post2Topics, _core_config__WEBPACK_IMPORTED_MODULE_7__[\"dbTblName\"].postTopics);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_8__[\"default\"].query(sql, [postId]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_10__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst topicsProc = async (req, res, next) => {\n  await _loadTopics(req, res, next);\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/list\", listProc);\nrouter.post(\"/latest\", latestProc);\nrouter.post(\"/save\", saveProc);\nrouter.post(\"/get\", getProc);\nrouter.post(\"/comment-list\", commentList);\nrouter.post(\"/write-comment\", writeComment);\nrouter.post(\"/post2topics\", post2TopicsProc);\nrouter.post(\"/topics\", topicsProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/api/posts.js?");

/***/ }),

/***/ "./routes/api/profile.js":
/*!*******************************!*\
  !*** ./routes/api/profile.js ***!
  \*******************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! uuid */ \"uuid\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(uuid__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var mkdirp__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! mkdirp */ \"mkdirp\");\n/* harmony import */ var mkdirp__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(mkdirp__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n/* harmony import */ var _core_myCrypto__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../core/myCrypto */ \"./core/myCrypto.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst avatarProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_12__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_12__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_10__[\"default\"][lang];\n  const {\n    userId\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `userId` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_8__[\"dbTblName\"].user_avatar);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_9__[\"default\"].query(sql, [userId]);\n\n    if (!!rows.length) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0][\"avatar\"]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.notFound\n      });\n    }\n  } catch (err) {\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError\n    });\n  }\n};\n\nconst saveAvatarProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_12__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_12__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_10__[\"default\"][lang];\n  const {\n    userId,\n    file\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_3___default()(today, \"yyyy-mm-dd\"); // const time = dateformat(today, \"hh:MM TT\");\n  // const timestamp = today.getTime();\n\n  const appDir = process.cwd();\n  const fileDir = path__WEBPACK_IMPORTED_MODULE_4___default.a.join(appDir, \"public\", _core_consts__WEBPACK_IMPORTED_MODULE_12__[\"default\"].uploadPath.avatars);\n  const fileName = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"%s%s\", uuid__WEBPACK_IMPORTED_MODULE_5___default()(), path__WEBPACK_IMPORTED_MODULE_4___default.a.extname(file.path));\n  const filePath = path__WEBPACK_IMPORTED_MODULE_4___default.a.join(fileDir, fileName);\n  const writable = fs__WEBPACK_IMPORTED_MODULE_6___default.a.createWriteStream(filePath);\n  const media = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"%s/%s\", _core_consts__WEBPACK_IMPORTED_MODULE_12__[\"default\"].uploadPath.avatars, fileName);\n  mkdirp__WEBPACK_IMPORTED_MODULE_7___default()(fileDir, () => {\n    file.on(\"end\", async e => {\n      const newRows = [[userId, media, date]];\n      let sql;\n      let rows;\n\n      if (userId) {\n        sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `userId` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_8__[\"dbTblName\"].user_avatar);\n        rows = await _core_db__WEBPACK_IMPORTED_MODULE_9__[\"default\"].query(sql, [userId]);\n\n        if (rows.length > 0) {\n          const oldFilename = path__WEBPACK_IMPORTED_MODULE_4___default.a.join(fileDir, path__WEBPACK_IMPORTED_MODULE_4___default.a.basename(rows[0][\"avatar\"]));\n          _core_tracer__WEBPACK_IMPORTED_MODULE_11__[\"default\"].debug(oldFilename);\n          fs__WEBPACK_IMPORTED_MODULE_6___default.a.unlink(oldFilename, e => {});\n        }\n      }\n\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `avatar` = VALUES(`avatar`), `updatedDate` = VALUES(`updatedDate`);\", _core_config__WEBPACK_IMPORTED_MODULE_8__[\"dbTblName\"].user_avatar);\n\n      try {\n        rows = await _core_db__WEBPACK_IMPORTED_MODULE_9__[\"default\"].query(sql, [newRows]);\n        res.status(200).send({\n          result: langs.success,\n          message: langs.successfullySaved,\n          data: rows\n        });\n      } catch (err) {\n        _core_tracer__WEBPACK_IMPORTED_MODULE_11__[\"default\"].error(JSON.stringify(err));\n        _core_tracer__WEBPACK_IMPORTED_MODULE_11__[\"default\"].error(__filename);\n        res.status(200).send({\n          result: langs.error,\n          message: langs.unknownServerError,\n          err\n        });\n      }\n    });\n    file.on(\"error\", err => {\n      _core_tracer__WEBPACK_IMPORTED_MODULE_11__[\"default\"].error(JSON.stringify(err));\n      _core_tracer__WEBPACK_IMPORTED_MODULE_11__[\"default\"].error(__filename);\n      res.status(200).send({\n        result: langs.error,\n        message: langs.unknownServerError,\n        err\n      });\n    });\n    file.pipe(writable);\n  });\n};\n\nconst saveProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_12__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_12__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_10__[\"default\"][lang];\n  let {\n    id,\n    email,\n    username,\n    firstName,\n    lastName,\n    gender,\n    birthday,\n    jobTitle,\n    sector,\n    company,\n    city,\n    phone\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_3___default()(today, \"yyyy-mm-dd\");\n  const newRows = [[id, email, \"\", username, firstName, lastName, gender, birthday, jobTitle, sector, company, city, phone, 0, 0, date, date, \"\", \"\"]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `email` = VALUES(`email`), `username` = VALUES(`username`), `firstName` = VALUES(`firstName`), `lastName` = VALUES(`lastName`), `gender` = VALUES(`gender`), `birthday` = VALUES(`birthday`), `jobTitle` = VALUES(`jobTitle`), `sector` = VALUES(`sector`), `company` = VALUES(`company`), `city` = VALUES(`city`), `phone` = VALUES(`phone`);\", _core_config__WEBPACK_IMPORTED_MODULE_8__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_9__[\"default\"].query(sql, [newRows]);\n    const token = jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default.a.sign({\n      id: id,\n      email: email,\n      firstName: firstName,\n      lastName: lastName\n    }, _core_config__WEBPACK_IMPORTED_MODULE_8__[\"session\"].secret);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: {\n        user: {\n          id,\n          email,\n          username,\n          firstName,\n          lastName,\n          gender,\n          birthday,\n          jobTitle,\n          sector,\n          company,\n          city,\n          phone\n        },\n        token\n      }\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_11__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_11__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst changePasswordProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_12__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_12__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_10__[\"default\"][lang];\n  let {\n    id,\n    password0,\n    password\n  } = req.body;\n  const hash0 = _core_myCrypto__WEBPACK_IMPORTED_MODULE_13__[\"default\"].hmacHex(password0 || \"\");\n  const hash = _core_myCrypto__WEBPACK_IMPORTED_MODULE_13__[\"default\"].hmacHex(password || \"\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `id` = ? AND `hash` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_8__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_9__[\"default\"].query(sql, [id, hash0]);\n\n    if (rows.length === 0) {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.currentPasswordIncorrect\n      });\n      return;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `hash` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_8__[\"dbTblName\"].users);\n    await _core_db__WEBPACK_IMPORTED_MODULE_9__[\"default\"].query(sql, [hash, id]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullyChanged\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_11__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_11__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/avatar\", avatarProc);\nrouter.post(\"/save-avatar\", saveAvatarProc);\nrouter.post(\"/save\", saveProc);\nrouter.post(\"/change-password\", changePasswordProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/api/profile.js?");

/***/ }),

/***/ "./routes/api/questionnaire.js":
/*!*************************************!*\
  !*** ./routes/api/questionnaire.js ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\nconst _loadPackages = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    scope,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql;\n\n  if (scope === _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].current) {\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, Q.count `questions` FROM `%s` P JOIN `%s` Q ON Q.packageId = P.id WHERE P.startDate <= ? AND P.endDate >= ? AND P.deletedDate = ? ORDER BY P.endDate DESC, P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestionsCount);\n  } else {\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, Q.count `questions` FROM `%s` P JOIN `%s` Q ON Q.packageId = P.id WHERE P.endDate < ? AND P.releasedDate != ? AND P.deletedDate = ? ORDER BY P.endDate DESC, P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestionsCount);\n  }\n\n  try {\n    let rows;\n\n    if (scope === _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].current) {\n      rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, date, \"\", start, pageSize]);\n    } else {\n      rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, \"\", \"\", start, pageSize]);\n    }\n\n    let rows1;\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `startDate` <= ? AND `endDate` >= ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, date, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0][\"count\"] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0][\"count\"],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadQuestions = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    packageId,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT Q.* FROM `%s` Q WHERE Q.packageId = ? AND Q.deletedDate = ? ORDER BY Q.timestamp;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\", start, pageSize]);\n    let rows1;\n\n    for (let row of rows) {\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `questionId` = ? ORDER BY `timestamp` ASC;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireAnswers);\n      rows1 = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [row.id]);\n      row[\"answers\"] = rows1;\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `questionId` = ? AND `userId` = ? AND `checked` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireResult);\n      rows1 = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [row.id, userId, 1]);\n      row[\"answered\"] = [];\n\n      for (let row1 of rows1) {\n        row[\"answered\"].push(row1[\"answerId\"]);\n      }\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `packageId` = ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0][\"count\"] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0][\"count\"],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadResult = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    packageId,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT Q.*, C.count `answersCount` FROM `%s` Q LEFT JOIN `%s` C ON C.questionId = Q.id WHERE Q.packageId = ? AND Q.deletedDate = ? ORDER BY Q.timestamp ASC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireAnsweredCount);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\", start, pageSize]);\n    let rows1;\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `packageId` = ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0][\"count\"] / pageSize));\n    let index = start + 1;\n\n    for (let row of rows) {\n      row[\"index\"] = index++;\n      row[\"isEnded\"] = row[\"endDate\"] < date;\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT A.id, A.answer, IFNULL(C.count, 0) `count` FROM `%s` A LEFT JOIN `%s` C ON C.answerId = A.id WHERE A.questionId = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireAnswers, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireResultCount);\n      row[\"answers\"] = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [row.id]);\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`questionId`) `count` FROM `%s` WHERE `questionId` = ? AND `userId` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireResult);\n      rows1 = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [row.id, userId]);\n      row[\"answered\"] = !!rows1[0][\"count\"];\n    }\n\n    res.status(200).send({\n      result: langs.success,\n      count: count[0][\"count\"],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst packagesProc = async (req, res, next) => {\n  _loadPackages(req, res, next);\n};\n\nconst getPackageProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    packageId,\n    page,\n    pageSize\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` Q WHERE Q.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnairePackages);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst questionsProc = async (req, res, next) => {\n  _loadQuestions(req, res, next);\n};\n\nconst getProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireQuestions);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst updateProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    userId,\n    answers\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  const time = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"hh:MM TT\");\n  const timestamp = today.getTime();\n  let answersAlt = [];\n  let newRows = [];\n  let sql;\n\n  try {\n    Object.keys(answers).map(async item => {\n      answersAlt.push({\n        questionId: item,\n        answeredIds: answers[item]\n      });\n    });\n\n    for (let answer of answersAlt) {\n      newRows = [];\n\n      for (let answerId of answer.answeredIds) {\n        newRows.push([answer.questionId, userId, answerId, 1, timestamp, date, time]);\n      }\n\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `checked` = ? WHERE `userId` = ? AND `questionId` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireResult);\n      console.log(userId, answer.questionId, newRows);\n      await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [0, userId, answer.questionId]);\n      if (!answer.answeredIds.length) continue;\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `checked` = VALUES(`checked`), `timestamp` = VALUES(`timestamp`), `date` = VALUES(`date`), `time` = VALUES(`time`);\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].questionnaireResult);\n      await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]);\n    }\n\n    await _loadQuestions(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst resultProc = async (req, res, next) => {\n  _loadResult(req, res, next);\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/packages\", packagesProc);\nrouter.post(\"/get-package\", getPackageProc);\nrouter.post(\"/questions\", questionsProc); // router.post(\"/get\", getProc);\n\nrouter.post(\"/update\", updateProc);\nrouter.post(\"/result\", resultProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/api/questionnaire.js?");

/***/ }),

/***/ "./routes/api/video.js":
/*!*****************************!*\
  !*** ./routes/api/video.js ***!
  \*****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\nconst _loadData = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize2);\n  const start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName FROM `%s` P JOIN `%s` U ON U.id = P.userId WHERE P.deletedDate = ? AND P.userId LIKE ? ORDER BY P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].video, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\", userId || \"%%\", start, pageSize]);\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `deletedDate` = '%s' AND `userId` LIKE '%s';\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].video, \"\", userId || \"%%\");\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, null);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0]['count'] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0]['count'],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst listProc = async (req, res, next) => {\n  _loadData(req, res, next);\n};\n\nconst saveProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id,\n    title,\n    url,\n    isFile,\n    userId\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  const time = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"hh:MM TT\");\n  const timestamp = today.getTime();\n  const newRows = [[id || null, timestamp, userId, date, time, title, url, isFile, \"\"]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `title` = VALUES(`title`), `url` = VALUES(`url`), `isFile` = VALUES(`isFile`);\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].video);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]);\n    res.status(200).send({\n      result: langs.success,\n      message: langs.successfullySaved,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst deleteProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"UPDATE `%s` SET `deletedDate` = ? WHERE `id` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].video);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, id]);\n\n    _loadData(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst getProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, U.firstName, U.lastName FROM `%s` P JOIN `%s` U ON U.id = P.userId WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].video, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].users);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/list\", listProc); // router.post(\"/save\", saveProc);\n// router.post(\"/delete\", deleteProc);\n\nrouter.post(\"/get\", getProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/api/video.js?");

/***/ }),

/***/ "./routes/api/vote.js":
/*!****************************!*\
  !*** ./routes/api/vote.js ***!
  \****************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ \"express\");\n/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(express__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! sprintf-js */ \"sprintf-js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ \"dateformat\");\n/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _core_config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/config */ \"./core/config.js\");\n/* harmony import */ var _core_db__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/db */ \"./core/db.js\");\n/* harmony import */ var _core_strings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/strings */ \"./core/strings.js\");\n/* harmony import */ var _core_tracer__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/tracer */ \"./core/tracer.js\");\n/* harmony import */ var _core_consts__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/consts */ \"./core/consts.js\");\n\n\n\n\n\n\n\n\n\nconst _loadPackages = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    scope,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql;\n\n  if (scope === _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].current) {\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, Q.count `questions` FROM `%s` P JOIN `%s` Q ON Q.packageId = P.id WHERE P.startDate <= ? AND P.endDate >= ? AND P.deletedDate = ? ORDER BY P.endDate DESC, P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestionsCount);\n  } else {\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.*, Q.count `questions` FROM `%s` P JOIN `%s` Q ON Q.packageId = P.id WHERE P.releasedDate != ? AND P.deletedDate = ? ORDER BY P.endDate DESC, P.timestamp DESC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestionsCount);\n  }\n\n  try {\n    let rows;\n\n    if (scope === _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].current) {\n      rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, date, \"\", start, pageSize]);\n    } else {\n      rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [\"\", \"\", start, pageSize]);\n    }\n\n    let rows1;\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `startDate` <= ? AND `endDate` >= ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [date, date, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0][\"count\"] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0][\"count\"],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadQuestions = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    packageId,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT Q.*, R.answerId `answered` FROM `%s` Q LEFT JOIN `%s` R ON R.questionId = Q.id AND R.userId = ? WHERE Q.packageId = ? AND Q.deletedDate = ? ORDER BY Q.timestamp;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteResult);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [userId, packageId, \"\", start, pageSize]);\n    let rows1;\n\n    for (let row of rows) {\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `questionId` = ? ORDER BY `timestamp` ASC;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteAnswers);\n      rows1 = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [row.id]);\n      row[\"answers\"] = rows1;\n    }\n\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `packageId` = ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0][\"count\"] / pageSize));\n    res.status(200).send({\n      result: langs.success,\n      count: count[0][\"count\"],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst _loadResult = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    packageId,\n    page,\n    pageSize,\n    userId\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` WHERE `packageId` = ? AND `deletedDate` = ? ORDER BY `timestamp` ASC LIMIT ?, ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\", start, pageSize]);\n    let rows1;\n    sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`id`) `count` FROM `%s` WHERE `packageId` = ? AND `deletedDate` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions);\n    let count = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId, \"\"]);\n    let pageCount = 0;\n    count.length > 0 && (pageCount = Math.ceil(count[0][\"count\"] / pageSize));\n    let index = start + 1;\n\n    for (let row of rows) {\n      row[\"index\"] = index++;\n      row[\"isEnded\"] = row[\"endDate\"] < date;\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT A.id, A.answer, IFNULL(C.count, 0) `count` FROM `%s` A LEFT JOIN `%s` C ON C.answerId = A.id WHERE A.questionId = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteAnswers, _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteResultCount);\n      row[\"answers\"] = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [row.id]);\n      row[\"answersCount\"] = 0;\n\n      for (let item of row[\"answers\"]) {\n        row[\"answersCount\"] += item.count;\n      }\n\n      sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT COUNT(`questionId`) `count` FROM `%s` WHERE `questionId` = ? AND `userId` = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteResult);\n      rows1 = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [row.id, userId]);\n      row[\"answered\"] = !!rows1[0][\"count\"];\n    }\n\n    res.status(200).send({\n      result: langs.success,\n      count: count[0][\"count\"],\n      pageCount,\n      data: rows\n    });\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst packagesProc = async (req, res, next) => {\n  _loadPackages(req, res, next);\n};\n\nconst getPackageProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  let {\n    packageId,\n    page,\n    pageSize\n  } = req.body;\n  page || (page = 1);\n  pageSize || (pageSize = _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultPageSize);\n  const start = pageSize * (page - 1);\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT * FROM `%s` Q WHERE Q.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].votePackages);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [packageId]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst questionsProc = async (req, res, next) => {\n  _loadQuestions(req, res, next);\n};\n\nconst getProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    id\n  } = req.body;\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"SELECT P.* FROM `%s` P WHERE P.id = ?;\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteQuestions);\n\n  try {\n    let rows = await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [id]);\n\n    if (rows.length > 0) {\n      res.status(200).send({\n        result: langs.success,\n        data: rows[0]\n      });\n    } else {\n      res.status(200).send({\n        result: langs.error,\n        message: langs.noData\n      });\n    }\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst updateProc = async (req, res, next) => {\n  const lang = req.get(_core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].lang) || _core_consts__WEBPACK_IMPORTED_MODULE_7__[\"default\"].defaultLanguage;\n  const langs = _core_strings__WEBPACK_IMPORTED_MODULE_5__[\"default\"][lang];\n  const {\n    userId,\n    questionId,\n    answerId\n  } = req.body;\n  const today = new Date();\n  const date = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"yyyy-mm-dd\");\n  const time = dateformat__WEBPACK_IMPORTED_MODULE_2___default()(today, \"hh:MM TT\");\n  const timestamp = today.getTime();\n  const newRows = [[questionId, userId, answerId, timestamp, date, time]];\n  let sql = Object(sprintf_js__WEBPACK_IMPORTED_MODULE_1__[\"sprintf\"])(\"INSERT INTO `%s` VALUES ? ON DUPLICATE KEY UPDATE `answerId` = VALUES(`answerId`), `timestamp` = VALUES(`timestamp`), `date` = VALUES(`date`), `time` = VALUES(`time`);\", _core_config__WEBPACK_IMPORTED_MODULE_3__[\"dbTblName\"].voteResult);\n\n  try {\n    await _core_db__WEBPACK_IMPORTED_MODULE_4__[\"default\"].query(sql, [newRows]);\n\n    _loadQuestions(req, res, next);\n  } catch (err) {\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(JSON.stringify(err));\n    _core_tracer__WEBPACK_IMPORTED_MODULE_6__[\"default\"].error(__filename);\n    res.status(200).send({\n      result: langs.error,\n      message: langs.unknownServerError,\n      err\n    });\n  }\n};\n\nconst resultProc = async (req, res, next) => {\n  _loadResult(req, res, next);\n};\n\nconst router = express__WEBPACK_IMPORTED_MODULE_0___default.a.Router();\nrouter.post(\"/packages\", packagesProc);\nrouter.post(\"/get-package\", getPackageProc);\nrouter.post(\"/questions\", questionsProc); // router.post(\"/get\", getProc);\n\nrouter.post(\"/update\", updateProc);\nrouter.post(\"/result\", resultProc);\n/* harmony default export */ __webpack_exports__[\"default\"] = (router);\n\n//# sourceURL=webpack:///./routes/api/vote.js?");

/***/ }),

/***/ "cluster":
/*!**************************!*\
  !*** external "cluster" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"cluster\");\n\n//# sourceURL=webpack:///external_%22cluster%22?");

/***/ }),

/***/ "cookie-parser":
/*!********************************!*\
  !*** external "cookie-parser" ***!
  \********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"cookie-parser\");\n\n//# sourceURL=webpack:///external_%22cookie-parser%22?");

/***/ }),

/***/ "cors":
/*!***********************!*\
  !*** external "cors" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"cors\");\n\n//# sourceURL=webpack:///external_%22cors%22?");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"crypto\");\n\n//# sourceURL=webpack:///external_%22crypto%22?");

/***/ }),

/***/ "dateformat":
/*!*****************************!*\
  !*** external "dateformat" ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"dateformat\");\n\n//# sourceURL=webpack:///external_%22dateformat%22?");

/***/ }),

/***/ "ddos":
/*!***********************!*\
  !*** external "ddos" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"ddos\");\n\n//# sourceURL=webpack:///external_%22ddos%22?");

/***/ }),

/***/ "debug":
/*!************************!*\
  !*** external "debug" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"debug\");\n\n//# sourceURL=webpack:///external_%22debug%22?");

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"dotenv\");\n\n//# sourceURL=webpack:///external_%22dotenv%22?");

/***/ }),

/***/ "express":
/*!**************************!*\
  !*** external "express" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"express\");\n\n//# sourceURL=webpack:///external_%22express%22?");

/***/ }),

/***/ "express-form-data":
/*!************************************!*\
  !*** external "express-form-data" ***!
  \************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"express-form-data\");\n\n//# sourceURL=webpack:///external_%22express-form-data%22?");

/***/ }),

/***/ "express-jwt":
/*!******************************!*\
  !*** external "express-jwt" ***!
  \******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"express-jwt\");\n\n//# sourceURL=webpack:///external_%22express-jwt%22?");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"fs\");\n\n//# sourceURL=webpack:///external_%22fs%22?");

/***/ }),

/***/ "helmet":
/*!*************************!*\
  !*** external "helmet" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"helmet\");\n\n//# sourceURL=webpack:///external_%22helmet%22?");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"http\");\n\n//# sourceURL=webpack:///external_%22http%22?");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"https\");\n\n//# sourceURL=webpack:///external_%22https%22?");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"jsonwebtoken\");\n\n//# sourceURL=webpack:///external_%22jsonwebtoken%22?");

/***/ }),

/***/ "mkdirp":
/*!*************************!*\
  !*** external "mkdirp" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"mkdirp\");\n\n//# sourceURL=webpack:///external_%22mkdirp%22?");

/***/ }),

/***/ "morgan":
/*!*************************!*\
  !*** external "morgan" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"morgan\");\n\n//# sourceURL=webpack:///external_%22morgan%22?");

/***/ }),

/***/ "mysql2":
/*!*************************!*\
  !*** external "mysql2" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"mysql2\");\n\n//# sourceURL=webpack:///external_%22mysql2%22?");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"os\");\n\n//# sourceURL=webpack:///external_%22os%22?");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"path\");\n\n//# sourceURL=webpack:///external_%22path%22?");

/***/ }),

/***/ "request":
/*!**************************!*\
  !*** external "request" ***!
  \**************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"request\");\n\n//# sourceURL=webpack:///external_%22request%22?");

/***/ }),

/***/ "sprintf-js":
/*!*****************************!*\
  !*** external "sprintf-js" ***!
  \*****************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"sprintf-js\");\n\n//# sourceURL=webpack:///external_%22sprintf-js%22?");

/***/ }),

/***/ "tracer":
/*!*************************!*\
  !*** external "tracer" ***!
  \*************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"tracer\");\n\n//# sourceURL=webpack:///external_%22tracer%22?");

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = require(\"uuid\");\n\n//# sourceURL=webpack:///external_%22uuid%22?");

/***/ })

/******/ });